/**
 * timbre 0.0.0 / JavaScript Library for Objective Sound Programming
 */var timbre=function(a,b){"use strict";var b=function(){return b.fn.init.apply(b,arguments)};b.VERSION="0.0.0",b.BUILD="Sun May 20 2012 16:32:15 GMT+0900 (JST)",b.env="",b.platform="",b.samplerate=44100,b.channels=2,b.cellsize=128,b.streamsize=1024,b.amp=.8,b.verbose=!0,b.dacs=[],b.timers=[],b._ev={},b._sys=null,b._global={};var c=function(){var a=function(){d.apply(this,arguments)},c=a.prototype,d=function(a,c){a=a||b.streamsize,c=c||b.channels,c=c===1?1:2,this.streamsize=a,this.channels=c,this.L=new Float32Array(a),this.R=new Float32Array(a),this._impl=null,this._ison=!1,this._cell=new Float32Array(b.cellsize),this._cellsize=b.cellsize,this._seq_id=0};c.bind=function(a){this._impl=new a(this)},c.on=function(){this._impl&&(this._ison=!0,this._impl.on())},c.off=function(){this._impl&&(this._impl.off(),this._ison=!1)},c.process=function(){var a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;a=this._cell,c=this.L,d=this.R,u=b.amp,f=b.dacs,h=b.timers,e=this._seq_id,k=c.length,m=f.length,o=this._cellsize,q=this.streamsize/o,r=0;for(j=k;j--;)c[j]=d[j]=0;for(p=q;p--;){++e;for(l=h.length;l--;)(i=h[l])!==undefined&&i.seq(e);for(l=f.length;l--;)if((g=f[l])!==undefined){g.seq(e),s=g._L,t=g._R;for(n=0,j=r;n<o;++n,++j)c[j]+=s[n],d[j]+=t[n]}r=j}for(j=k=c.length;j--;)v=c[j]*u,v<-1?v=-1:1<v&&(v=1),c[j]=v,v=d[j]*u,v<-1?v=-1:1<v&&(v=1),d[j]=v;for(n=o;n--;)a[n]=c[n]+d[n],v=a[n]*u*.5,v<-1?v=-1:1<v&&(v=1),a[n]=v;this._seq_id=e};return a}();b._sys=new c,Object.defineProperty(b,"isOn",{get:function(){return b._sys._ison}}),Object.defineProperty(b,"isOff",{get:function(){return!b._sys._ison}}),b.on=function(){b._sys._ison||(b._sys.on(),b.fn.do_event(this,"on"));return b},b.off=function(){b._sys._ison&&(b._sys.off(),b.fn.do_event(this,"off"));return b},b.addEventListener=function(a,b){var c,d,e;typeof b=="function"&&(a[0]==="~"&&(a=a.substr(1),b.rm=!0),c=this._ev[a],c===undefined&&(this._ev[a]=c=[]),(e=c.indexOf(b))===-1&&c.push(b));return this},b.removeEventListener=function(a,b){var c,d;typeof a=="string"&&a!==""&&(c=this._ev[a],c!==undefined&&(d=c.indexOf(b))!==-1&&c.splice(d,1));return this},b.removeAllEventListeners=function(a){typeof a=="string"&&a!==""&&(delete this._ev[a],delete this["on"+a]);return this},b.fn=function(a){var b={},c={};c.find=function(a){if(typeof c[a]=="function")return c[a]},b.init=function(){var b,i,j,k;b=Array.prototype.slice.call(arguments),i=b[0];switch(typeof i){case"string":j=c.find(i),j&&(k=new j(b.slice(1)));break;case"number":k=new d([i]);break;case"boolean":k=new e([i]);break;case"function":k=new f(b);break;case"object":i&&typeof i.clone=="function"&&(k=i.clone())}k===undefined&&(i===null?k=new h:k=new g),k._seq_id=-1,k._cell||(k._cell=new Float32Array(a.cellsize)),k.args||(k.args=[]),a.fn.init_set.call(k.args),k._ev||(k._ev={}),typeof k._ar!="boolean"&&(k._ar=!1),k._seq=k.seq,k._post_init&&k._post_init();return k};var i=function(){var b=new Float32Array(a.cellsize);return function(){return b}}(),j={};j.play=function(){this.dac.on()},j.pause=function(){this.dac.off()},j.bang=function(){a.fn.do_event(this,"bang");return this},j.seq=function(){return this._cell},j.on=function(){this.seq=this._seq,a.fn.do_event(this,"on");return this},j.off=function(){this.seq=i,a.fn.do_event(this,"off");return this},j.clone=function(){return new this._klass(this.args)},j.append=function(){this.args.append.apply(this.args,arguments);return this},j.remove=function(){this.args.remove.apply(this.args,arguments);return this},j.set=function(a,b){var c;c=this;while(c!==null){if(Object.getOwnPropertyDescriptor(c,a)){this[a]=b;break}c=Object.getPrototypeOf(c)}return this},j.get=function(a){var b,c;b=this;while(b!==null){if(Object.getOwnPropertyDescriptor(b,a)){c=this[a];break}b=Object.getPrototypeOf(b)}return c},j.addEventListener=a.addEventListener,j.removeEventListener=a.removeEventListener,j.removeAllEventListeners=a.removeAllEventListeners,j.properties={},j.properties.isAr={get:function(){return!!this._ar}},j.properties.isKr={get:function(){return!this._ar}},j.properties.dac={set:function(a){this._dac&&this._dac.remove(this),this._dac=a.append(this)},get:function(){this._dac||(this._dac=a("dac",this));return this._dac}},j.properties.mul={set:function(a){typeof a=="number"&&(this._mul=a)},get:function(){return this._mul}},j.properties.add={set:function(a){typeof a=="number"&&(this._add=a)},get:function(){return this._add}},b.register=function(a,b,d){var e,f;if(typeof b=="function"){f=b.prototype;for(e in j)typeof j[e]=="function"&&(f[e]||(f[e]=j[e]));for(e in j.properties)Object.getOwnPropertyDescriptor(f,e)||Object.defineProperty(f,e,j.properties[e]);f._mul=1,f._add=0,typeof a=="string"&&(d?c[a]=d:(f._klass=b,f._name=a,c[a]=b))}},b.valist=function(b){var c,d,e;c=[];for(d=0,e=b.length;d<e;++d)switch(typeof b[d]){case"number":case"boolean":case"function":case"undefined":c.push(a(b[d]));break;case"object":b[d]===null?c.push(a(null)):c.push(b[d]);break;default:c.push(a(undefined))}return c},b.init_set=function(){var a=function(){var a,c;a=b.valist(arguments);for(c=a.length;c--;)this.indexOf(a[c])===-1&&this.push(a[c]);return this},c=function(){var a,b;for(a=arguments.length;a--;)(b=this.indexOf(arguments[a]))!==-1&&this.splice(b,1);return this},d=function(){this.append.apply(this,list)};return function(){this.append=a,this.remove=c,this.update=d;return this}}(),b.do_event=function(a,b,c){var d,e,f;d=a["on"+b],typeof d=="function"&&d.apply(a,c),e=a._ev[b];if(e!==undefined)for(f=e.length;f--;)d=e[f],d.apply(a,c),d.rm&&a.removeEventListener(b,d)};return b}(b),b.fn.init_set.call(b.dacs),b.fn.init_set.call(b.timers);var d=function(){var a=function(){c.apply(this,arguments)},b=a.prototype;Object.defineProperty(b,"value",{set:function(a){var b,c;if(typeof a=="number"){this._value=a,b=this._cell;for(c=b.length;c--;)b[c]=a}},get:function(){return this._value}});var c=function(a){typeof a[0]=="number"?this._value=a[0]:this._value=0};b._post_init=function(){this.value=this._value},b.clone=function(){return new a([this.value])};return a}();b.fn.register("number",d);var e=function(){var a=function(){c.apply(this,arguments)},b=a.prototype;Object.defineProperty(b,"value",{set:function(a){var b,c,d;this._value=!!a,b=this._cell,d=this._value?1:0;for(c=b.length;c--;)b[c]=d},get:function(){return this._value}});var c=function(a){typeof a[0]=="boolean"?this._value=a[0]:this._value=!1};b._post_init=function(){this.value=this._value},b.clone=function(){return new a([this.value])};return a}();b.fn.register("boolean",e);var f=function(){var a=function(){e.apply(this,arguments)},c=a.prototype,d=function(a){return a};Object.defineProperty(c,"func",{set:function(a){typeof a=="function"&&(this._func=a)},get:function(){return this._func}}),Object.defineProperty(c,"freq",{set:function(a){typeof a=="object"?this._freq=a:this._freq=b(a)},get:function(){return this._freq}}),Object.defineProperty(c,"phase",{set:function(a){if(typeof a=="number"){while(a>=1)a-=1;while(a<0)a+=1;this._x=this._phase=a}},get:function(){return this._phase}});var e=function(a){var c,e;c=0,typeof a[c]=="function"?this.func=a[c++]:this.func=d,this.freq=a[c++],typeof a[c]=="number"?this.phase=a[c++]:this.phase=0,typeof a[c]=="number"&&(this.mul=a[c++]),typeof a[c]=="number"&&(this.add=a[c++]),this._x=this._phase,this._coeff=1/b.samplerate};c.clone=function(){return new a([this.func,this.freq,this.phase,this.mul,this.add])},c.bang=function(){this._x=this._phase,b.fn.do_event(this,"bang");return this},c.seq=function(a){var b,c,d,e,f;b=this._cell;if(a!==this._seq_id){c=this._x,d=this._func(c)*this._mul+this._add;for(e=b.length;e--;)b[e]=d;c+=this._freq.seq(a)[0]*this._coeff;while(c>=1)c-=1;this._x=c,this._seq_id=a}return b};return a}();b.fn.register("function",f);var g=function(){};b.fn.register("undefined",g);var h=function(){};b.fn.register("null",h);var i=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"dac",{get:function(){return this}}),Object.defineProperty(c,"amp",{set:function(a){typeof a=="number"&&(this._amp=a)},get:function(){return this._amp}}),Object.defineProperty(c,"pan",{set:function(a){typeof a=="number"&&(this._pan=a,this._panL=Math.cos(.5*Math.PI*this._pan),this._panR=Math.sin(.5*Math.PI*this._pan))},get:function(){return this._pan}}),Object.defineProperty(c,"isOn",{get:function(){return this._ison}}),Object.defineProperty(c,"isOff",{get:function(){return!this._ison}});var d=function(a){this.args=b.fn.valist.call(this,a),this._L=new Float32Array(b.cellsize),this._R=new Float32Array(b.cellsize),this._pan=.5,this._panL=Math.cos(.5*Math.PI*this._pan),this._panR=Math.sin(.5*Math.PI*this._pan),this._amp=1,this._ison=!1,this._ar=!0};c.on=c.play=function(){this._ison=!0,b.dacs.append(this),b.fn.do_event(this,"on");return this},c.off=c.pause=function(){this._ison=!1,b.dacs.remove(this),b.fn.do_event(this,"off");return this},c.seq=function(a){var c,d,e,f,g,h,i,j,k,l,m;d=this._cell;if(a!==this._seq_id){c=this.args,e=this._L,f=this._R,g=this._amp,h=this._panL*g,i=this._panR*g,m=b.cellsize;for(l=m;l--;)d[l]=e[l]=f[l]=0;for(k=c.length;k--;){j=c[k].seq(a);for(l=m;l--;)d[l]+=j[l]*g,e[l]+=j[l]*h,f[l]+=j[l]*i}this._seq_id=a}return d};return a}();b.fn.register("dac",i);var j=function(){var a=function(){d.apply(this,arguments)},c=a.prototype,d=function(a){this.args=b.fn.valist.call(this,a),this._ar=!0};c.seq=function(a){var c,d,e,f,g,h;d=this._cell;if(a!==this._seq_id){c=this.args,h=b.cellsize;for(g=h;g--;)d[g]=0;for(f=c.length;f--;){e=c[f].seq(a);for(g=h;g--;)d[g]+=e[g]}this._seq_id=a}return d};return a}();b.fn.register("+",j);var k=function(){var a=function(){d.apply(this,arguments)},c=a.prototype,d=function(a){this.args=b.fn.valist.call(this,a),this._ar=!0};c.seq=function(a){var c,d,e,f,g,h;d=this._cell;if(a!==this._seq_id){c=this.args,h=b.cellsize;for(g=h;g--;)d[g]=1;for(f=c.length;f--;){e=c[f].seq(a);for(g=h;g--;)d[g]*=e[g]}this._seq_id=a}return d};return a}();b.fn.register("*",k);var l=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"wavelet",{set:function(b){var c,d,e;c=this._wavelet;if(typeof b=="function")for(d=0;d<1024;d++)c[d]=b(d/1024);else if(typeof b=="string"&&b instanceof Float32Array){e=b.length/1024;for(d=0;d<1024;d++)c[d]=b[d*e|0]||0}else if(typeof b=="string"&&(e=a.wavelets[b])!==undefined)for(d=0;d<1024;d++)c[d]=e[d]},get:function(){return this._wavelet}}),Object.defineProperty(c,"freq",{set:function(a){typeof a=="object"?this._freq=a:this._freq=b(a)},get:function(){return this._freq}}),Object.defineProperty(c,"phase",{set:function(a){if(typeof a=="number"){while(a>=1)a-=1;while(a<0)a+=1;this._phase=a,this._x=1024*this._phase}},get:function(){return this._phase}});var d=function(a){var c;c=0,this._wavelet=new Float32Array(1024),typeof a[c]=="function"?this.wavelet=a[c++]:typeof a[c]=="object"&&a[c]instanceof Float32Array?this.wavelet=a[c++]:typeof a[c]=="string"&&(this.wavelet=a[c++]),this.freq=a[c++],typeof a[c]=="number"?this.phase=a[c++]:this.phase=0,typeof a[c]=="number"&&(this.mul=a[c++]),typeof a[c]=="number"&&(this.add=a[c++]),this._x=1024*this._phase,this._coeff=1024/b.samplerate,this._ar=!0};c.clone=function(){return new a([this.wavelet,this.freq,this.phase,this.mul,this.add])},c.bang=function(){this._x=1024*this._phase,b.fn.do_event(this,"bang");return this},c.ar=function(){this._ar=!0;return this},c.kr=function(){this._ar=!1;return this},c.seq=function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;c=this._cell;if(a!==this._seq_id){d=this._freq.seq(a),e=this._mul*this._mul,f=this._add,g=this._wavelet,h=this._x,j=this._coeff;if(this._ar)if(this._freq._ar)for(p=0,q=b.cellsize;p<q;++p)k=h|0,l=h-k,m=g[k&1023],n=g[k+1&1023],o=(1-l)*m+l*n,c[p]=o*e+f,h+=d[p]*j;else{i=d[0]*j;for(p=0,q=b.cellsize;p<q;++p)k=h|0,l=h-k,m=g[k&1023],n=g[k+1&1023],o=(1-l)*m+l*n,c[p]=o*e+f,h+=i}else{k=h|0,l=h-k,m=g[k&1023],n=g[k+1&1023],o=(1-l)*m+l*n,o=o*e+f;for(p=0,q=b.cellsize;p<q;++p)c[p]=o;h+=d[0]*j*q}this._x=h,this._seq_id=a}return c};return a}();b.fn.register("osc",l),l.wavelets={},l.wavelets.sin=function(){var a,b;a=new Float32Array(1024);for(b=0;b<1024;++b)a[b]=Math.sin(2*Math.PI*(b/1024));return a}(),l.wavelets.cos=function(){var a,b;a=new Float32Array(1024);for(b=0;b<1024;++b)a[b]=Math.cos(2*Math.PI*(b/1024));return a}(),l.wavelets.pulse=function(){var a,b;a=new Float32Array(1024);for(b=0;b<1024;++b)a[b]=b<512?-1:1;return a}(),l.wavelets.tri=function(){var a,b,c;a=new Float32Array(1024);for(c=0;c<1024;++c)b=c/1024-.25,a[c]=1-4*Math.abs(Math.round(b)-b);return a}(),l.wavelets.sawup=function(){var a,b,c;a=new Float32Array(1024);for(c=0;c<1024;++c)b=c/1024,a[c]=2*(b-Math.round(b));return a}(),l.wavelets.saw=l.wavelets.sawup,l.wavelets.sawdown=function(){var a,b,c;a=new Float32Array(1024);for(c=0;c<1024;++c)b=c/1024,a[c]=-2*(b-Math.round(b));return a}(),l.wavelets.fami=function(){var a,b,c,d,e;b=[0,.125,.25,.375,.5,.625,.75,.875,.875,.75,.625,.5,.375,.25,.125,0,-0.125,-0.25,-0.375,-0.5,-0.625,-0.75,-0.875,-1,-1,-0.875,-0.75,-0.625,-0.5,-0.375,-0.25,-0.125],a=new Float32Array(1024);for(d=0;d<1024;++d)a[d]=b[d/1024*b.length|0];return a}(),l.wavelets.konami=function(){var a,b,c,d,e;b=[-0.625,-0.875,-0.125,.75,.5,.125,.5,.75,.25,-0.125,.5,.875,.625,0,.25,.375,-0.125,-0.75,0,.625,.125,-0.5,-0.375,-0.125,-0.75,-1,-0.625,0,-0.375,-0.875,-0.625,-0.25],a=new Float32Array(1024);for(d=0;d<1024;++d)a[d]=b[d/1024*b.length|0];return a}(),b.fn.register("sin",function(a){return new l(["sin"].concat(a))}),b.fn.register("cos",function(a){return new l(["cos"].concat(a))}),b.fn.register("pulse",function(a){return new l(["pulse"].concat(a))}),b.fn.register("tri",function(a){return new l(["tri"].concat(a))}),b.fn.register("saw",function(a){return new l(["saw"].concat(a))}),b.fn.register("sawup",function(a){return new l(["sawup"].concat(a))}),b.fn.register("sawdown",function(a){return new l(["sawdown"].concat(a))}),b.fn.register("fami",function(a){return new l(["fami"].concat(a))}),b.fn.register("konami",function(a){return new l(["konami"].concat(a))});var m=function(){var a=function(){c.apply(this,arguments)},b=a.prototype,c=function(a){var b;b=0,typeof a[b]=="number"&&(this.mul=a[b++]),typeof a[b]=="number"&&(this.add=a[b++]),this._ar=!0};b.ar=function(){this._ar=!0;return this},b.kr=function(){this._ar=!1;return this},b.seq=function(a){var b,c,d,e,f;b=this._cell;if(a!==this._seq_id){c=this._mul,d=this._add;if(this._ar)for(f=b.length;f--;)b[f]=(Math.random()*2-1)*c+d;else{e=(Math.random()*2-1)*c+d;for(f=b.length;f--;)b[f]=e}this._seq_id=a}return b};return a}();b.fn.register("noise",m);var n=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"a",{set:function(a){typeof a=="number"&&(this._a=a)},get:function(){return this._a}}),Object.defineProperty(c,"d",{set:function(a){typeof a=="number"&&(this._d=a)},get:function(){return this._d}}),Object.defineProperty(c,"s",{set:function(a){typeof a=="number"&&(this._s=a)},get:function(){return this._s}}),Object.defineProperty(c,"r",{set:function(a){typeof a=="number"&&(this._r=a)},get:function(){return this._r}});var d=function(a){var c;c=0,typeof a[c]=="number"?this.a=a[c++]:this.a=0,typeof a[c]=="number"?this.d=a[c++]:this.d=0,typeof a[c]=="number"?this.s=a[c++]:this.s=0,typeof a[c]=="number"?this.r=a[c++]:this.r=0,typeof a[c]=="number"&&(this.mul=a[c++]),typeof a[c]=="number"&&(this.add=a[c++]),this._mode=0,this._samplesMax=b.samplerate*(this._a/1e3)|0,this._samples=0};c.bang=function(){this._mode=0,this._samplesMax=b.samplerate*(this._a/1e3)|0,this._samples=0,b.fn.do_event(this,"bang"),b.fn.do_event(this,"A");return this},c.keyOff=function(){this._mode=3,this._samples=0,this._samplesMax=b.samplerate*(this._r/1e3)|0,b.fn.do_event(this,"R");return this},c.seq=function(a){var c,d,e,f,g,h,i,j,k,l,m;c=this._cell;if(a!==this._seq_id){d=this._mode,e=this._samples,f=this._samplesMax,g=this._mul,h=this._add,i=this._s,j=1-this._s;while(e>=f){if(d===0){this._mode=1,this._samples-=f,this._samplesMax=b.samplerate*(this._d/1e3)|0,b.fn.do_event(this,"D"),d=this._mode,f=this._samplesMax,e=this._samples;continue}if(d===1){this._mode=2,this._samples=0,this._samplesMax=Infinity,b.fn.do_event(this,"S"),d=this._mode,f=this._samplesMax,e=this._samples;continue}if(d===3){this._mode=4,this._samples=0,this._samplesMax=Infinity,b.fn.do_event(this,"ended"),d=this._mode,f=this._samplesMax,e=this._samples;continue}}switch(d){case 0:k=e/f;break;case 1:k=e/f,k=(1-k)*j+i;break;case 2:k=i;break;case 3:k=e/f,k=(1-k)*i;break;default:k=0}k=k*g+h;for(l=0,m=c.length;l<m;++l)c[l]=k;this._mode=d,this._samples=e+m,this._samplesMax=f}return c};return a}();b.fn.register("adsr",n);var o=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"type",{set:function(b){var c;typeof b=="string"&&(c=a.functions[b])!==undefined&&(this._type=b,this._func=c)},get:function(){return this._type}}),Object.defineProperty(c,"d",{set:function(a){typeof a=="number"&&(this._d=a)},get:function(){return this._d}}),Object.defineProperty(c,"start",{set:function(a){typeof a=="number"&&(this._start=a)},get:function(){return this._start}}),Object.defineProperty(c,"stop",{set:function(a){typeof a=="number"&&(this._stop=a)},get:function(){return this._stop}});var d=function(b){var c,d;c=0,typeof b[c]=="string"&&a.functions[b[c]]!==undefined?d=b[c++]:d="linear",typeof b[c]=="number"?this.d=b[c++]:this.d=1e3,typeof b[c]=="number"?this.start=b[c++]:this.start=0,typeof b[c]=="number"?this.stop=b[c++]:this.stop=1,typeof b[c]=="number"&&(this.mul=b[c++]),typeof b[c]=="number"&&(this.add=b[c++]),this._phase=0,this._phaseStep=0,this._value=0,this._enabled=!1,this.type=d};c.bang=function(){var a;a=this._stop-this._start,this._phase=0,this._phaseStep=b.cellsize/(this._d/1e3*b.samplerate),this._value=this._func(0)*a+this._start,this._enabled=!0;return this},c.seq=function(a){var c,d,e,f,g,h,i;c=this._cell;if(a!==this._seq_id){this._enabled?(this._phase+=this._phaseStep,this._phase<1?g=!1:(this._phase=1,this._enabled=!1,g=!0),e=this._stop-this._start,this._value=this._func(this._phase)*e+this._start,f=!0):f=!1,d=this._value*this._mul+this._add;for(h=0,i=b.cellsize;h<i;++h)c[h]=d;f&&this.onchanged&&this.onchanged(this._value),g&&b.fn.do_event(this,"ended")}return c};return a}();b.fn.register("tween",o),o.functions={linear:function(a){return a},"quadratic.in":function(a){return a*a},"quadratic.out":function(a){return a*(2-a)},"quadratic.inout":function(a){if((a*=2)<1)return.5*a*a;return-0.5*(--a*(a-2)-1)},"cubic.in":function(a){return a*a*a},"cubic.out":function(a){return--a*a*a+1},"cubic.inout":function(a){if((a*=2)<1)return.5*a*a*a;return.5*((a-=2)*a*a+2)},"quartic.in":function(a){return a*a*a*a},"quartic.out":function(a){return 1- --a*a*a*a},"quartic.inout":function(a){if((a*=2)<1)return.5*a*a*a*a;return-0.5*((a-=2)*a*a*a-2)},"quintic.in":function(a){return a*a*a*a*a},"quintic.out":function(a){return--a*a*a*a*a+1},"quintic.inout":function(a){if((a*=2)<1)return.5*a*a*a*a*a;return.5*((a-=2)*a*a*a*a+2)},"sinusoidal.in":function(a){return 1-Math.cos(a*Math.PI/2)},"sinusoidal.out":function(a){return Math.sin(a*Math.PI/2)},"sinusoidal.inout":function(a){return.5*(1-Math.cos(Math.PI*a))},"exponential.in":function(a){return a===0?0:Math.pow(1024,a-1)},"exponential.out":function(a){return a===1?1:1-Math.pow(2,-10*a)},"exponential.inout":function(a){if(a===0)return 0;if(a===1)return 1;if((a*=2)<1)return.5*Math.pow(1024,a-1);return.5*(-Math.pow(2,-10*(a-1))+2)},"circular.in":function(a){return 1-Math.sqrt(1-a*a)},"circular.out":function(a){return Math.sqrt(1- --a*a)},"circular.inout":function(a){if((a*=2)<1)return-0.5*(Math.sqrt(1-a*a)-1);return.5*(Math.sqrt(1-(a-=2)*a)+1)},"elastic.in":function(a){var b,c=.1,d=.4;if(a===0)return 0;if(a===1)return 1;!c||c<1?(c=1,b=d/4):b=d*Math.asin(1/c)/(2*Math.PI);return-(c*Math.pow(2,10*(a-=1))*Math.sin((a-b)*2*Math.PI/d))},"elastic.out":function(a){var b,c=.1,d=.4;if(a===0)return 0;if(a===1)return 1;!c||c<1?(c=1,b=d/4):b=d*Math.asin(1/c)/(2*Math.PI);return c*Math.pow(2,-10*a)*Math.sin((a-b)*2*Math.PI/d)+1},"elastic.inout":function(a){var b,c=.1,d=.4;if(a===0)return 0;if(a===1)return 1;!c||c<1?(c=1,b=d/4):b=d*Math.asin(1/c)/(2*Math.PI);if((a*=2)<1)return-0.5*c*Math.pow(2,10*(a-=1))*Math.sin((a-b)*2*Math.PI/d);return c*Math.pow(2,-10*(a-=1))*Math.sin((a-b)*2*Math.PI/d)*.5+1},"back.in":function(a){var b=1.70158;return a*a*((b+1)*a-b)},"back.out":function(a){var b=1.70158;return--a*a*((b+1)*a+b)+1},"back.inout":function(a){var b=2.5949095;if((a*=2)<1)return.5*a*a*((b+1)*a-b);return.5*((a-=2)*a*((b+1)*a+b)+2)},"bounce.in":function(a){return 1-o.functions["bounce.out"](1-a)},"bounce.out":function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},"bounce.inout":function(a){if(a<.5)return o.functions["bounce.in"](a*2)*.5;return o.functions["bounce.out"](a*2-1)*.5+.5}};var p=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"d",{set:function(a){typeof a=="number"&&(this._d=a)},get:function(){return this._d}});var d=function(a){var c;c=0,typeof a[c]=="number"?this.d=a[c++]:this.d=100,typeof a[c]=="number"&&(this.mul=a[c++]),typeof a[c]=="number"&&(this.add=a[c++]),typeof a[c]=="function"&&(this.onended=a[c++]),this._samples=0,this._dx=b.cellsize/this._samples,this._x=0};c.bang=function(){this._samples=b.samplerate*(this._d/1e3)|0,this._dx=b.cellsize/this._samples,this._x=1,b.fn.do_event(this,"bang");return this},c.seq=function(a){var c,d,e,f,g,h,i;c=this._cell;if(a!==this._seq_id){e=this._x,f=this._dx,g=this._samples,d=e*this._mul+this._add;for(h=0,i=c.length;h<i;++h)c[h]=d;e-=f,e<0&&(e=0),g>0&&(g-=i,g<=0&&(this._samples=0,b.fn.do_event(this,"ended"),e=this._x,g=this._samples)),this._x=e,this._samples=g}return c};return a}();b.fn.register("perc",p);var q=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"type",{set:function(b){var c;typeof b=="string"&&(c=a.types[b])!==undefined&&(this._type=b,typeof this._freq!="number"&&(this._freq=c.default_freq),typeof this._band!="number"&&(this._band=c.default_band),this._set_params=c.set_params,this._set_params(this._freq,this._band,this._gain))},get:function(){return this._type}}),Object.defineProperty(c,"freq",{set:function(a){typeof a=="number"&&(this._freq=a,this._set_params(this._freq,this._band,this._gain))},get:function(){return this._freq}}),Object.defineProperty(c,"band",{set:function(a){typeof a=="number"&&(this._band=a,this._set_params(this._freq,this._band,this._gain))},get:function(){return this._band}}),Object.defineProperty(c,"gain",{set:function(a){typeof a=="number"&&(this._gain=a,this._set_params(this._freq,this._band,this._gain))},get:function(){return this._gain}});var d=function(c){var d,e;this._mul=1,this._add=0,this._gain=6,d=0,typeof c[d]=="string"&&a.types[c[d]]!==undefined?e=c[d++]:e="LPF",typeof c[d]=="number"&&(this._freq=c[d++]),typeof c[d]=="number"&&(this._band=c[d++]),(e==="peaking"||e==="lowboost"||e==="highboost")&&typeof c[d]=="number"&&(this._gain=c[d++]),typeof c[d]=="number"&&(this._mul=c[d++]),typeof c[d]=="number"&&(this._add=c[d++]),this.args=b.fn.valist.call(this,c.slice(d)),this._ison=!0,this._in1=this._in2=this._out1=this._out2=0,this._ar=!0,this.type=e};c.on=function(){this._ison=!0,b.fn.do_event(this,"on");return this},c.off=function(){this._ison=!1,b.fn.do_event(this,"off");return this},c.seq=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;c=this._cell;if(a!==this._seq_id){b=this.args;for(i=j=c.length;i--;)c[i]=0;for(g=b.length;g--;){f=b[g].seq(a);for(i=j;i--;)c[i]+=f[i]}if(this._ison){d=this._mul,e=this._add,k=this._a1,l=this._a2,m=this._b0,n=this._b1,o=this._b2,p=this._in1,q=this._in2,r=this._out1,s=this._out2;for(g=0,h=c.length;g<h;++g)t=c[g],u=m*t+n*p+o*q-k*r-l*s,u>1?u=1:u<-1&&(u=-1),q=p,p=t,s=r,r=u,c[g]=u*d+e;this._in1=p,this._in2=q,this._out1=r,this._out2=s}this._seq_id=a}return c};return a}();q.types={},q.types.LPF={default_freq:800,default_band:1,set_params:function(a,c){var d,e,f,g,h,i;d=a*2*Math.PI/b.samplerate,e=Math.cos(d),f=Math.sin(d),h=.34657359027997264*c*d/f,g=f*(Math.exp(h)-Math.exp(-h))*.5,i=1/(1+g),this._a1=-2*e*i,this._a2=(1-g)*i,this._b1=(1-e)*i,this._b2=this._b0=this._b1*.5}},q.types.HPF={default_freq:5500,default_band:1,set_params:function(a,c){var d,e,f,g,h,i;d=a*2*Math.PI/b.samplerate,e=Math.cos(d),f=Math.sin(d),h=.34657359027997264*c*d/f,g=f*(Math.exp(h)-Math.exp(-h))*.5,i=1/(1+g),this._a1=-2*e*i,this._a2=+(1-g)*i,this._b1=-(1+e)*i,this._b2=this._b0=-this._b1*.5}},q.types.BPF={default_freq:3e3,default_band:1,set_params:function(a,c){var d,e,f,g,h,i;d=a*2*Math.PI/b.samplerate,e=Math.cos(d),f=Math.sin(d),h=.34657359027997264*c*d/f,g=f*(Math.exp(h)-Math.exp(-h))*.5,i=1/(1+g),this._a1=-2*e*i,this._a2=(1-g)*i,this._b0=g*i,this._b1=0,this._b2=-this._b0}},q.types.BRF={default_freq:3e3,default_band:1,set_params:function(a,c){var d,e,f,g,h,i;d=a*2*Math.PI/b.samplerate,e=Math.cos(d),f=Math.sin(d),h=.34657359027997264*c*d/f,g=f*(Math.exp(h)-Math.exp(-h))*.5,i=1/(1+g),this._a1=-2*e*i,this._a2=+(1-g)*i,this._b0=1,this._b1=-(1+e)*i,this._b2=1}},q.types.allpass={default_freq:3e3,default_band:1,set_params:function(a,c){var d,e,f,g,h,i;d=a*2*Math.PI/b.samplerate,e=Math.cos(d),f=Math.sin(d),h=.34657359027997264*c*d/f,g=f*(Math.exp(h)-Math.exp(-h))*.5,i=1/(1+g),this._a1=-2*e*i,this._a2=+(1-g)*i,this._b0=this._a2,this._b1=this._a1,this._b2=1}},q.types.peaking={default_freq:3e3,default_band:1,set_params:function(a,c,d){var e,f,g,h,i,j,k,l,m;e=Math.pow(10,d*.025),f=a*2*Math.PI/b.samplerate,g=Math.cos(f),h=Math.sin(f),l=.34657359027997264*c*f/h,i=h*(Math.exp(l)-Math.exp(-l))*.5,j=i*e,k=i/e,m=1/(1+k),this._a1=-2*g*m,this._a2=+(1-k)*m,this._b0=+(1+j)*m,this._b1=this._a1,this._b2=+(1-j)*m}},q.types.lowboost={default_freq:3e3,default_band:1,set_params:function(a,c,d){var e,f,g,h,i,j,k;e=Math.pow(10,d*.025),f=a*2*Math.PI/b.samplerate,g=Math.cos(f),h=Math.sin(f),i=h*.5*Math.sqrt((e+1/e)*(1/c-1)+2),j=i*Math.sqrt(e)*2,k=1/(e+1+(e-1)*g+j),this._a1=-2*(e-1+(e+1)*g)*k,this._a2=(e+1+(e-1)*g-j)*k,this._b0=(e+1-(e-1)*g+j)*e*k,this._b1=2*(e-1-(e+1)*g)*e*k,this._b2=(e+1-(e-1)*g-j)*e*k}},q.types.highboost={default_freq:5500,default_band:1,set_params:function(a,c,d){var e,f,g,h,i,j,k;e=Math.pow(10,d*.025),f=a*2*Math.PI/b.samplerate,g=Math.cos(f),h=Math.sin(f),i=h*.5*Math.sqrt((e+1/e)*(1/c-1)+2),j=i*Math.sqrt(e)*2,k=1/(e+1+(e-1)*g+j),this._a1=2*(e-1+(e+1)*g)*k,this._a2=(e+1+(e-1)*g-j)*k,this._b0=(e+1-(e-1)*g+j)*e*k,this._b1=-2*(e-1-(e+1)*g)*e*k,this._b2=(e+1-(e-1)*g-j)*e*k}},b.fn.register("LPF",q,function(a){return new q(["LPF"].concat(a))}),b.fn.register("HPF",q,function(a){return new q(["HPF"].concat(a))}),b.fn.register("BPF",q,function(a){return new q(["BPF"].concat(a))}),b.fn.register("BRF",q,function(a){return new q(["BRF"].concat(a))}),b.fn.register("allpass",q,function(a){return new q(["allpass"].concat(a))}),b.fn.register("peaking",q,function(a){return new q(["peaking"].concat(a))}),b.fn.register("lowboost",q,function(a){return new q(["lowboost"].concat(a))}),b.fn.register("highboost",q,function(a){return new q(["highboost"].concat(a))});var r=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;a.types={LPF:0,HPF:1,BPF:2,BRF:3},Object.defineProperty(c,"type",{set:function(b){var c;typeof b=="string"&&(c=a.types[b])!==undefined&&(this._type=b,this._mode=c,this._set_params(this._cutoff,this._Q))},get:function(){return this._type}}),Object.defineProperty(c,"cutoff",{set:function(a){typeof a=="number"&&(this._cutoff=a,this._set_params(this._cutoff,this._Q))},get:function(){return this._cutoff}}),Object.defineProperty(c,"Q",{set:function(a){typeof a=="number"&&(this._Q=a,this._set_params(this._cutoff,this._Q))},get:function(){return this._Q}}),Object.defineProperty(c,"depth",{set:function(a){typeof a=="number"&&(this._depth=a,this._depth0=Math.cos(.5*Math.PI*a),this._depth1=Math.sin(.5*Math.PI*a))},get:function(){return this._depth}});var d=function(c){var d,e;d=0,typeof c[d]=="string"&&a.types[c[d]]!==undefined?e=c[d++]:e="LPF",typeof c[d]=="number"?this._cutoff=c[d++]:this._cutoff=2e3,typeof c[d]=="number"?this._Q=c[d++]:this._Q=0,typeof c[d]=="number"?this.depth=c[d++]:this.depth=.5,typeof c[d]=="number"&&(this.mul=c[d++]),typeof c[d]=="number"&&(this.add=c[d++]),this.args=b.fn.valist.call(this,c.slice(d)),this._ison=!0,this._f=new Float32Array(4),this._mode=0,this._damp=0,this._freq=0,this._ar=!0,this.type=e};c._set_params=function(a,c){var d=2*Math.sin(Math.PI*Math.min(.25,a/(b.samplerate*2)));this._damp=Math.min(2*(1-Math.pow(c,.25)),Math.min(2,2/d-d*.5)),this._freq=d},c.on=function(){this._ison=!0,b.fn.do_event(this,"on");return this},c.off=function(){this._ison=!1,b.fn.do_event(this,"off");return this},c.seq=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r;c=this._cell;if(a!==this._seq_id){b=this.args;for(i=j=c.length;i--;)c[i]=0;for(g=b.length;g--;){f=b[g].seq(a);for(i=j;i--;)c[i]+=f[i]}if(this._ison){d=this._mul,e=this._add,k=this._f,l=this._mode,m=this._damp,n=this._freq,o=this._depth0,p=this._depth1;for(g=0,h=c.length;g<h;++g)q=c[g],k[3]=q-m*k[2],k[0]=k[0]+n*k[2],k[1]=k[3]-k[0],k[2]=n*k[1]+k[2],r=.5*k[l],k[3]=q-m*k[2],k[0]=k[0]+n*k[2],k[1]=k[3]-k[0],k[2]=n*k[1]+k[2],r+=.5*k[l],r=q*o+r*p,c[g]=r*d+e}this._seq_id=a}return c};return a}();b.fn.register("rLPF",r,function(a){return new r(["LPF"].concat(a))}),b.fn.register("rHPF",r,function(a){return new r(["HPF"].concat(a))}),b.fn.register("rBPF",r,function(a){return new r(["BPF"].concat(a))}),b.fn.register("rBRF",r,function(a){return new r(["BRF"].concat(a))});var s=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"interval",{set:function(a){typeof a=="number"&&(this._interval=a,this._interval_samples=b.samplerate*(a/1e3)|0)},get:function(){return this._interval}}),Object.defineProperty(c,"isOn",{get:function(){return this._ison}}),Object.defineProperty(c,"isOff",{get:function(){return!this._ison}});var d=function(a){var b;this._interval_samples=0,b=0,typeof a[b]=="number"&&(this.interval=a[b++]),this.args=a.slice(b),this._ison=!1,this._samples=0,this._interval_count=0};c.on=c.play=function(){this._ison=!0,this._samples=this._interval_samples,this._interval_count=0,b.timers.append(this),b.fn.do_event(this,"on");return this},c.off=c.pause=function(){this._ison=!1,b.timers.remove(this),b.fn.do_event(this,"off");return this},c.bang=function(){this._ison&&(this._samples=this._interval_samples,b.fn.do_event(this,"bang"));return this},c.seq=function(a){var c,d,e,f;if(a!==this._seq_id){if(this._interval_samples!==0){c=this._samples-b.cellsize;if(c<=0){this._samples=c+this._interval_samples,d=this._interval_count,e=this.args;for(f=e.length;f--;)typeof e[f]=="function"?e[f](d):e[f].bang==="function"&&e[f].bang();++this._interval_count,c=this._samples}this._samples=c}this._seq_id=a}return this._cell};return a}();b.fn.register("interval",s);var t=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"timeout",{set:function(a){typeof a=="number"&&(this._timeout=a,this._timeout_samples=b.samplerate*(a/1e3)|0)},get:function(){return this._timeout}}),Object.defineProperty(c,"isOn",{get:function(){return this._ison}}),Object.defineProperty(c,"isOff",{get:function(){return!this._ison}});var d=function(a){var b;this._timeout_samples=0,b=0,typeof a[b]=="number"&&(this.timeout=a[b++]),this.args=a.slice(b),this._ison=!1,this._samples=0};c.on=c.play=function(){this._ison=!0,this._samples=this._timeout_samples,b.timers.append(this),b.fn.do_event(this,"on");return this},c.off=c.pause=function(){this._ison=!1,b.timers.remove(this),b.fn.do_event(this,"off");return this},c.bang=function(){this._ison&&(this._samples=this._timeout_samples,b.fn.do_event(this,"bang"));return this},c.seq=function(a){var c,d,e;if(a!==this._seq_id){if(this._timeout_samples!==0){c=this._samples-b.cellsize;if(c<=0){this._samples=0,d=this.args;for(e=d.length;e--;)typeof d[e]=="function"?d[e]():d[e].bang==="function"&&d[e].bang();c=this._samples,c<=0&&this.off()}this._samples=c}this._seq_id=a}return this._cell};return a}();b.fn.register("timeout",t),typeof window=="object"&&function(a,b){var c=function(){var b=function(){e.apply(this,arguments)},c=b.prototype,d=function(){var b,c,d;b=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder,c=a.URL||a.webkitURL;if(b&&c){d=new b,d.append("onmessage=t=function(e){clearInterval(t);if(i=e.data)t=setInterval(function(){postMessage(0)},i)}");return c.createObjectURL(d.getBlob())}return null}(),e=function(){d?this._timer=new Worker(d):this._timer=null,this._timerId=0,this._ugly_patch=0};c.setInterval=
function(b,c){this._timer!==null?(this._timer.onmessage=b,this._timer.postMessage(c),/mac.*firefox/i.test(a.navigator.userAgent)&&(a.clearInterval(this._ugly_patch),this._ugly_patch=a.setInterval(function(){},1e3))):(this._timerId!==0&&a.clearInterval(this._timerId),this._timerId=a.setInterval(b,c))},c.clearInterval=function(){this._timer!==null?(this._timer.postMessage(0),this._ugly_patch&&(a.clearInterval(this._ugly_patch),this._ugly_patch=0)):this._timerId!==0&&(a.clearInterval(this._timerId),this._timerId=0)};return b}(),d=function(a){var c,d;c=new webkitAudioContext,b.samplerate=c.sampleRate,d=c.createJavaScriptNode(a.streamsize,0,a.channels),d.onaudioprocess=function(b){var c,d,e,f,g;a.process(),c=a.L,d=a.R,e=b.outputBuffer.getChannelData(0),f=b.outputBuffer.getChannelData(1);for(g=e.length;g--;)e[g]=c[g],f[g]=d[g]};return{on:function(){d.connect(c.destination)},off:function(){d.disconnect()}}},e=function(a){var d,e,f,g,h;d=new Audio,d.mozSetup(a.channels,b.samplerate),b.samplerate=d.mozSampleRate,b.channels=d.mozChannels,e=new c,f=a.streamsize/b.samplerate*1e3,g=new Float32Array(a.streamsize*a.channels),h=function(){var b,c,e,f;d.mozWriteAudio(g),a.process(),b=a.L,c=a.R,e=g.length,f=b.length;while(f--)g[--e]=c[f],g[--e]=b[f]};return{on:function(){e.setInterval(h,f)},off:function(){e.clearInterval()}}};typeof webkitAudioContext=="function"?(b.env="webkit",b._sys.bind(d)):typeof Audio=="function"&&typeof (new Audio).mozSetup=="function"&&(b.env="moz",b._sys.bind(e)),b.platform="web",b._global=a,a.T=b}(a,b),typeof importScripts=="function"&&function(a,b){b.platform="web",b._global=a}(a,b),typeof process=="object"&&process.title==="node"&&function(a,b){b.platform="node",b._global=global,module.exports=b}(a,b);return b}(this)