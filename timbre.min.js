/**
 * timbre 0.0.0 / JavaScript Library for Objective Sound Programming
 */var timbre=function(a,b){"use strict";var b=function(){return b.fn.init.apply(b,arguments)};b.VERSION="0.0.0",b.BUILD="Fri May 18 2012 23:51:08 GMT+0900 (JST)",b.env="",b.platform="",b.samplerate=44100,b.channels=2,b.cellsize=128,b.streamsize=1024,b.amp=.8,b.verbose=!0,b.dacs=[],b._ev={},b._sys=null,b._global={};var c=function(){var a=function(){d.apply(this,arguments)},c=a.prototype,d=function(a,c){a=a||b.streamsize,c=c||b.channels,c=c===1?1:2,this.streamsize=a,this.channels=c,this.L=new Float32Array(a),this.R=new Float32Array(a),this._impl=null,this._ison=!1,this._cell=new Float32Array(b.cellsize),this._cellsize=b.cellsize,this._seq_id=0};c.bind=function(a){this._impl=new a(this)},c.on=function(){this._impl&&(this._ison=!0,this._impl.on())},c.off=function(){this._impl&&(this._impl.off(),this._ison=!1)},c.process=function(){var a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;a=this._cell,c=this.L,d=this.R,s=b.amp,f=b.dacs,e=this._seq_id,i=c.length,k=f.length,m=this._cellsize,o=this.streamsize/m,p=0;for(h=i;h--;)c[h]=d[h]=0;for(n=o;n--;){++e;for(j=f.length;j--;){g=f[j],g.seq(e),q=g._L,r=g._R;for(l=0,h=p;l<m;++l,++h)c[h]+=q[l],d[h]+=r[l]}p=h}for(h=i=c.length;h--;)t=c[h]*s,t<-1?t=-1:1<t&&(t=1),c[h]=t,t=d[h]*s,t<-1?t=-1:1<t&&(t=1),d[h]=t;for(l=m;l--;)a[l]=c[l]+d[l],t=a[l]*s*.5,t<-1?t=-1:1<t&&(t=1),a[l]=t;this._seq_id=e};return a}();b._sys=new c,Object.defineProperty(b,"isOn",{get:function(){return b._sys._ison}}),Object.defineProperty(b,"isOff",{get:function(){return!b._sys._ison}}),b.on=function(){b._sys._ison||(b._sys.on(),b.fn.do_event(this,"on"));return b},b.off=function(){b._sys._ison&&(b._sys.off(),b.fn.do_event(this,"off"));return b},b.addEventListener=function(a,b){var c,d;typeof b=="function"&&(c=this._ev[a],c===undefined&&(this._ev[a]=c=[]),(d=c.indexOf(b))===-1&&c.push(b));return this},b.removeEventListener=function(a,b){var c,d;typeof a=="string"&&a!==""&&(c=this._ev[a],c!==undefined&&(d=c.indexOf(b))!==-1&&c.splice(d,1));return this},b.removeAllEventListeners=function(a){typeof a=="string"&&a!==""&&(delete this._ev[a],delete this["on"+a]);return this},b.fn=function(a){var b={},c={};c.find=function(a){if(typeof c[a]=="function")return c[a]},b.init=function(){var a,b,i,j;a=Array.prototype.slice.call(arguments),b=a[0];switch(typeof b){case"string":i=c.find(b),i&&(j=new i(a.slice(1)));break;case"number":j=new d([b]);break;case"boolean":j=new e([b]);break;case"function":j=new f(a);break;case"object":b&&typeof b.clone=="function"&&(j=b.clone())}j===undefined&&(b===null?j=new h:j=new g);return k.call(j)},b.register=function(a,b){typeof b=="function"&&typeof a=="string"&&(b.prototype._klass=b,b.prototype._name=a,c[a]=b)},b.valist=function(b){var c,d,e;c=[];for(d=0,e=b.length;d<e;++d)switch(typeof b[d]){case"number":case"boolean":case"function":case"undefined":c.push(a(b[d]));break;case"object":b[d]===null?c.push(a(null)):c.push(b[d]);break;default:c.push(a(undefined))}return c},b.init_set=function(){var a=function(){var a,c;a=b.valist(arguments);for(c=a.length;c--;)this.indexOf(a[c])===-1&&this.push(a[c]);return this},c=function(){var a,b;for(a=arguments.length;a--;)(b=this.indexOf(arguments[a]))!==-1&&this.splice(b,1);return this},d=function(){this.append.apply(this,list)};return function(){this.append=a,this.remove=c,this.update=d;return this}}(),b.do_event=function(a,b,c){var d,e,f;d=a["on"+b],typeof d=="function"&&d.apply(a,c),e=a._ev[b];if(e!==undefined)for(f=e.length;f--;)e[f].apply(a,c)};var i=function(){var b=new Float32Array(a.cellsize);return function(){return b}}(),j={};j.seq=function(){return this._cell},j.on=function(){this.seq=this._seq,a.fn.do_event(this,"on");return this},j.off=function(){this.seq=i,a.fn.do_event(this,"off");return this},j.clone=function(){return new this._klass(this.args)},j.set=function(a,b){var c;c=this;while(c!==null){if(Object.getOwnPropertyDescriptor(c,a)){this[a]=b;break}c=Object.getPrototypeOf(c)}return this},j.get=function(a){var b,c;b=this;while(b!==null){if(Object.getOwnPropertyDescriptor(b,a)){c=this[a];break}b=Object.getPrototypeOf(b)}return c},j.bang=function(){a.fn.do_event(this,"bang");return this},j.ar=function(){this._ar=!0;return this},j.kr=function(){this._ar=!1;return this},j.nop=function(){return this},j.addEventListener=a.addEventListener,j.removeEventListener=a.removeEventListener,j.removeAllEventListeners=a.removeAllEventListeners;var k=function(){this._seq_id=-1,this._cell||(this._cell=new Float32Array(a.cellsize)),this.args||(this.args=[]),a.fn.init_set.call(this.args),this._ev||(this._ev={}),this.set||(this.set=j.set),this.get||(this.get=j.get),this.bang||(this.bang=j.bang),this.ar||(this._kr_only||this._ar_only?this.ar=j.nop:this.ar=j.ar),this.kr||(this._kr_only||this._ar_only?this.kr=j.nop:this.kr=j.kr),Object.defineProperty(this,"isAr",{get:function(){return this._ar}}),Object.defineProperty(this,"isKr",{get:function(){return!this._ar}}),typeof this._ar!="boolean"&&(this._ar=!!this._ar_only),typeof this.seq!="function"&&(this.seq=j.seq),this._seq=this.seq,typeof this.on!="function"&&(this.on=j.on),typeof this.off!="function"&&(this.off=j.off),typeof this.clone!="function"&&(this.clone=j.clone),typeof this.addEventListener!="function"&&(this.addEventListener=j.addEventListener),typeof this.removeEventListener!="function"&&(this.removeEventListener=j.removeEventListener),this._post_init&&this._post_init();return this};return b}(b),b.fn.init_set.call(b.dacs);var d=function(){var a=function(){c.apply(this,arguments)},b=a.prototype;Object.defineProperty(b,"value",{set:function(a){var b,c;if(typeof a=="number"){this._value=a,b=this._cell;for(c=b.length;c--;)b[c]=a}},get:function(){return this._value}});var c=function(a){typeof a[0]=="number"?this._value=a[0]:this._value=0};b._kr_only=!0,b._post_init=function(){this.value=this._value},b.clone=function(){return new a([this.value])};return a}();b.fn.register("number",d);var e=function(){var a=function(){c.apply(this,arguments)},b=a.prototype;Object.defineProperty(b,"value",{set:function(a){var b,c,d;this._value=!!a,b=this._cell,d=this._value?1:0;for(c=b.length;c--;)b[c]=d},get:function(){return this._value}});var c=function(a){typeof a[0]=="boolean"?this._value=a[0]:this._value=!1};b._kr_only=!0,b._post_init=function(){this.value=this._value},b.clone=function(){return new a([this.value])};return a}();b.fn.register("boolean",e);var f=function(){var a=function(){e.apply(this,arguments)},c=a.prototype,d=function(a){return a};Object.defineProperty(c,"func",{set:function(a){var b;typeof a=="function"&&(this._func=a,b=this._func(0),b instanceof Float32Array||b instanceof Array?(this.seq=this._seq=f,this._array_saved=[],this._array_index=0):(typeof b!="number"&&(this._func=d),this.seq=this._seq=g,delete this._array_saved,delete this._array_index))},get:function(){return this._func}}),Object.defineProperty(c,"freq",{set:function(a){typeof a=="object"?this._freq=a:this._freq=b(a)},get:function(){return this._freq}}),Object.defineProperty(c,"phase",{set:function(a){if(typeof a=="number"){while(a>=1)a-=1;while(a<0)a+=1;this._x=this._phase=a}},get:function(){return this._phase}}),Object.defineProperty(c,"mul",{set:function(a){typeof a=="number"&&(this._mul=a)},get:function(){return this._mul}}),Object.defineProperty(c,"add",{set:function(a){typeof a=="number"&&(this._add=a)},get:function(){return this._add}});var e=function(a){var c,e;c=0,typeof a[c]=="function"?this.func=a[c++]:this.func=d,this.freq=a[c++],typeof a[c]=="number"?this.phase=a[c++]:this.phase=0,typeof a[c]=="number"?this.mul=a[c++]:this.mul=1,typeof a[c]=="number"?this.add=a[c++]:this.add=0,this._x=this._phase,this._coeff=1/b.samplerate};c._kr_only=!0,c.clone=function(){return new a([this.func,this.freq,this.phase,this.mul,this.add])},c.bang=function(){this._x=this._phase,b.fn.do_event(this,"bang");return this};var f=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;b=this._cell;if(a!==this._seq_id){c=this._func,e=this._freq.seq(a),f=this._mul,g=this._add,h=this._x,i=this._coeff,d=this._array_saved,l=this._array_index,m=d.length;for(j=0,k=b.length;j<k;++j,++l){l>=m&&(d=c(h,e[j]*i),l=0,m=d.length),b[j]=d[l]*f+g,h+=e[j]*i;while(h>=1)h-=1}this._array_saved=d,this._array_index=l,this._x=h,this._seq_id=a}return b},g=function(a){var b,c,d,e,f,g,h,i,j;b=this._cell;if(a!==this._seq_id){c=this._func,d=this._freq.seq(a),e=this._mul,f=this._add,g=this._x,h=this._coeff;for(i=0,j=b.length;i<j;++i){b[i]=c(g)*e+f,g+=d[i]*h;while(g>=1)g-=1}this._x=g,this._seq_id=a}return b};return a}();b.fn.register("function",f);var g=function(){};g.prototype._kr_only=!0,b.fn.register("undefined",g);var h=function(){};h.prototype._kr_only=!0,b.fn.register("null",h);var i=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"amp",{set:function(a){typeof a=="number"&&(this._amp=a)},get:function(){return this._amp}}),Object.defineProperty(c,"pan",{set:function(a){typeof a=="number"&&(this._pan=a,this._panL=Math.cos(.5*Math.PI*this._pan),this._panR=Math.sin(.5*Math.PI*this._pan))},get:function(){return this._pan}}),Object.defineProperty(c,"isOn",{get:function(){return this._ison}}),Object.defineProperty(c,"isOff",{get:function(){return!this._ison}});var d=function(a){this.args=b.fn.valist.call(this,a),this._L=new Float32Array(b.cellsize),this._R=new Float32Array(b.cellsize),this._pan=.5,this._panL=Math.cos(.5*Math.PI*this._pan),this._panR=Math.sin(.5*Math.PI*this._pan),this._amp=1,this._ison=!1};c._ar_only=!0,c.on=function(){this._ison=!0,b.dacs.append(this),b.fn.do_event(this,"on");return this},c.off=function(){this._ison=!1,b.dacs.remove(this),b.fn.do_event(this,"off");return this},c.seq=function(a){var c,d,e,f,g,h,i,j,k,l,m;d=this._cell;if(a!==this._seq_id){c=this.args,e=this._L,f=this._R,g=this._amp,h=this._panL*g,i=this._panR*g,m=b.cellsize;for(l=m;l--;)d[l]=e[l]=f[l]=0;for(k=c.length;k--;){j=c[k].seq(a);for(l=m;l--;)d[l]+=j[l]*g,e[l]+=j[l]*h,f[l]+=j[l]*i}this._seq_id=a}return d};return a}();b.fn.register("dac",i);var j=function(){var a=function(){d.apply(this,arguments)},c=a.prototype,d=function(a){this.args=b.fn.valist.call(this,a)};c._ar_only=!0,c.seq=function(a){var c,d,e,f,g,h;d=this._cell;if(a!==this._seq_id){c=this.args,h=b.cellsize;for(g=h;g--;)d[g]=0;for(f=c.length;f--;){e=c[f].seq(a);for(g=h;g--;)d[g]+=e[g]}this._seq_id=a}return d};return a}();b.fn.register("+",j);var k=function(){var a=function(){d.apply(this,arguments)},c=a.prototype,d=function(a){this.args=b.fn.valist.call(this,a)};c._ar_only=!0,c.seq=function(a){var c,d,e,f,g,h;d=this._cell;if(a!==this._seq_id){c=this.args,h=b.cellsize;for(g=h;g--;)d[g]=1;for(f=c.length;f--;){e=c[f].seq(a);for(g=h;g--;)d[g]*=e[g]}this._seq_id=a}return d};return a}();b.fn.register("*",k);var l=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"wavelet",{set:function(b){var c,d,e;c=this._wavelet;if(typeof b=="function")for(d=0;d<1024;d++)c[d]=b(d/1024);else if(typeof b=="string"&&b instanceof Float32Array){e=b.length/1024;for(d=0;d<1024;d++)c[d]=b[d*e|0]||0}else if(typeof b=="string"&&(e=a.wavelets[b])!==undefined)for(d=0;d<1024;d++)c[d]=e[d]},get:function(){return this._wavelet}}),Object.defineProperty(c,"freq",{set:function(a){typeof a=="object"?this._freq=a:this._freq=b(a)},get:function(){return this._freq}}),Object.defineProperty(c,"phase",{set:function(a){if(typeof a=="number"){while(a>=1)a-=1;while(a<0)a+=1;this._phase=a,this._x=1024*this._phase}},get:function(){return this._phase}}),Object.defineProperty(c,"mul",{set:function(a){typeof a=="number"&&(this._mul=a)},get:function(){return this._mul}}),Object.defineProperty(c,"add",{set:function(a){typeof a=="number"&&(this._add=a)},get:function(){return this._add}});var d=function(a){var c;c=0,this._wavelet=new Float32Array(1024),typeof a[c]=="function"?this.wavelet=a[c++]:typeof a[c]=="object"&&a[c]instanceof Float32Array?this.wavelet=a[c++]:typeof a[c]=="string"&&(this.wavelet=a[c++]),this.freq=a[c++],typeof a[c]=="number"?this.phase=a[c++]:this.phase=0,typeof a[c]=="number"?this.mul=a[c++]:this.mul=1,typeof a[c]=="number"?this.add=a[c++]:this.add=0,this._x=1024*this._phase,this._coeff=1024/b.samplerate,this._ar=!0};c.clone=function(){return new a([this.wavelet,this.freq,this.phase,this.mul,this.add])},c.bang=function(){this._x=1024*this._phase,b.fn.do_event(this,"bang");return this},c.seq=function(a){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;c=this._cell;if(a!==this._seq_id){d=this._freq.seq(a),e=this._mul*this._mul,f=this._add,g=this._wavelet,h=this._x,j=this._coeff;if(this._ar)if(this._freq.ar)for(p=0,q=b.cellsize;p<q;++p)k=h|0,l=h-k,m=g[k&1023],n=g[k+1&1023],o=(1-l)*m+l*n,c[p]=o*e+f,h+=d[p]*j;else{i=d[0]*j;for(p=0,q=b.cellsize;p<q;++p)k=h|0,l=h-k,m=g[k&1023],n=g[k+1&1023],o=(1-l)*m+l*n,c[p]=o*e+f,h+=i}else{k=h|0,l=h-k,m=g[k&1023],n=g[k+1&1023],o=(1-l)*m+l*n,o=o*e+f;for(p=0,q=b.cellsize;p<q;++p)c[p]=o;h+=d[0]*j*q}this._x=h,this._seq_id=a}return c};return a}();b.fn.register("osc",l),l.wavelets={},l.wavelets.sin=function(){var a,b;a=new Float32Array(1024);for(b=0;b<1024;++b)a[b]=Math.sin(2*Math.PI*(b/1024));return a}(),l.wavelets.cos=function(){var a,b;a=new Float32Array(1024);for(b=0;b<1024;++b)a[b]=Math.cos(2*Math.PI*(b/1024));return a}(),l.wavelets.pulse=function(){var a,b;a=new Float32Array(1024);for(b=0;b<1024;++b)a[b]=b<512?-1:1;return a}(),l.wavelets.tri=function(){var a,b,c;a=new Float32Array(1024);for(c=0;c<1024;++c)b=c/1024-.25,a[c]=1-4*Math.abs(Math.round(b)-b);return a}(),l.wavelets.sawup=function(){var a,b,c;a=new Float32Array(1024);for(c=0;c<1024;++c)b=c/1024,a[c]=2*(b-Math.round(b));return a}(),l.wavelets.saw=l.wavelets.sawup,l.wavelets.sawdown=function(){var a,b,c;a=new Float32Array(1024);for(c=0;c<1024;++c)b=c/1024,a[c]=-2*(b-Math.round(b));return a}(),l.wavelets.fami=function(){var a,b,c,d,e;b=[0,.125,.25,.375,.5,.625,.75,.875,.875,.75,.625,.5,.375,.25,.125,0,-0.125,-0.25,-0.375,-0.5,-0.625,-0.75,-0.875,-1,-1,-0.875,-0.75,-0.625,-0.5,-0.375,-0.25,-0.125],a=new Float32Array(1024);for(d=0;d<1024;++d)a[d]=b[d/1024*b.length|0];return a}(),l.wavelets.konami=function(){var a,b,c,d,e;b=[-0.625,-0.875,-0.125,.75,.5,.125,.5,.75,.25,-0.125,.5,.875,.625,0,.25,.375,-0.125,-0.75,0,.625,.125,-0.5,-0.375,-0.125,-0.75,-1,-0.625,0,-0.375,-0.875,-0.625,-0.25],a=new Float32Array(1024);for(d=0;d<1024;++d)a[d]=b[d/1024*b.length|0];return a}(),b.fn.register("sin",function(a){return new l(["sin"].concat(a))}),b.fn.register("cos",function(a){return new l(["cos"].concat(a))}),b.fn.register("pulse",function(a){return new l(["pulse"].concat(a))}),b.fn.register("tri",function(a){return new l(["tri"].concat(a))}),b.fn.register("saw",function(a){return new l(["saw"].concat(a))}),b.fn.register("sawup",function(a){return new l(["sawup"].concat(a))}),b.fn.register("sawdown",function(a){return new l(["sawdown"].concat(a))}),b.fn.register("fami",function(a){return new l(["fami"].concat(a))}),b.fn.register("konami",function(a){return new l(["konami"].concat(a))});var m=function(){var a=function(){d.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"a",{set:function(a){typeof a=="number"&&(this._a=a)},get:function(){return this._a}}),Object.defineProperty(c,"d",{set:function(a){typeof a=="number"&&(this._d=a)},get:function(){return this._d}}),Object.defineProperty(c,"s",{set:function(a){typeof a=="number"&&(this._s=a)},get:function(){return this._s}}),Object.defineProperty(c,"r",{set:function(a){typeof a=="number"&&(this._r=a)},get:function(){return this._r}}),Object.defineProperty(c,"mul",{set:function(a){typeof a=="number"&&(this._mul=a)},get:function(){return this._mul}}),Object.defineProperty(c,"add",{set:function(a){typeof a=="number"&&(this._add=a)},get:function(){return this._add}});var d=function(a){var c;c=0,typeof a[c]=="number"?this.a=a[c++]:this.a=0,typeof a[c]=="number"?this.d=a[c++]:this.d=0,typeof a[c]=="number"?this.s=a[c++]:this.s=0,typeof a[c]=="number"?this.r=a[c++]:this.r=0,typeof a[c]=="number"?this.mul=a[c++]:this.mul=1,typeof a[c]=="number"?this.add=a[c++]:this.add=0,this._mode=0,this._samplesMax=b.samplerate*(this._a/1e3)|0,this._samples=0};c._kr_only=!0,c.bang=function(){this._mode=0,this._samplesMax=b.samplerate*(this._a/1e3)|0,this._samples=0,b.fn.do_event(this,"bang");return this},c.keyOff=function(){this._mode=3,this._samples=0,this._samplesMax=b.samplerate*(this._r/1e3)|0;return this},c.seq=function(a){var c,d,e,f,g,h,i,j,k,l,m;c=this._cell;if(a!==this._seq_id){d=this._mode,e=this._samples,f=this._samplesMax,g=this._mul,h=this._add,i=this._s,j=1-this._s;if(!this._ar){while(e>=f){if(d===0){this._mode=1,this._samples-=f,this._samplesMax=b.samplerate*(this._d/1e3)|0,b.fn.do_event(this,"Aended"),d=this._mode,f=this._samplesMax,e=this._samples;continue}if(d===1){this._mode=2,this._samples=0,this._samplesMax=Infinity,b.fn.do_event(this,"Dended"),d=this._mode,f=this._samplesMax,e=this._samples;continue}if(d===3){d=4,this._samples=0,this._samplesMax=Infinity,b.fn.do_event(this,"Rended"),d=this._mode,f=this._samplesMax,e=this._samples;continue}}switch(d){case 0:k=e/f;break;case 1:k=e/f,k=(1-k)*j+i;break;case 2:k=i;break;case 3:k=e/f,k=(1-k)*j;break;default:k=0}k=k*g+h;for(l=0,m=c.length;l<m;++l)c[l]=k;this._mode=d,this._samples=e+m,this._samplesMax=f}}return c};return a}();b.fn.register("adsr",m);var n=function(){var a=function(){e.apply(this,arguments)},c=a.prototype;Object.defineProperty(c,"duration",{set:function(a){typeof a=="number"&&(this._duration=a)},get:function(){return this._duration}});var d=function(){},e=function(a){var c;c=0,typeof a[c]=="number"?this.duration=a[c++]:this.duration=0,typeof a[c]=="function"?this.onended=a[c++]:this.onended=d,this._samples=b.samplerate*(this._duration/1e3)|0,this._dx=1/this._samples,this._x=1};c.bang=function(){this._samples=b.samplerate*(this._duration/1e3)|0,this._dx=1/this._samples,this._x=1,b.fn.do_event(this,"bang");return this},c.seq=function(a){var b,c,d,e,f,g;b=this._cell;if(a!==this._seq_id){c=this._x,d=this._dx,e=this._samples;if(this._ar)for(f=0,g=b.length;f<g;++f)b[f]=c,c-=d,c<0&&(c=0),e>0&&(e-=1,e<=0&&(this._samples=0,this.onended(),c=this._x,d=this._dx,e=this._samples));else{for(f=0,g=b.length;f<g;++f)b[f]=c;c-=d*g,c<0&&(c=0),e>0&&(e-=g,e<=0&&(this._samples=0,this.onended(),c=this._x,d=this._dx,e=this._samples))}this._x=c,this._samples=e}return b};return a}();b.fn.register("perc",n),typeof window=="object"&&function(a,b){var c=function(){var b=function(){e.apply(this,arguments)},c=b.prototype,d=function(){var b,c,d;b=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder,c=a.URL||a.webkitURL;if(b&&c){d=new b,d.append("onmessage=t=function(e){clearInterval(t);if(i=e.data)t=setInterval(function(){postMessage(0)},i)}");return c.createObjectURL(d.getBlob())}return null}(),e=function(){d?this._timer=new Worker(d):this._timer=null,this._timerId=0,this._ugly_patch=0};c.setInterval=function(b,c){this._timer!==null?(this._timer.onmessage=b,this._timer.postMessage(c),/mac.*firefox/i.test(a.navigator.userAgent)&&(a.clearInterval(this._ugly_patch),this._ugly_patch=a.setInterval(function(){},1e3))):(this._timerId!==0&&a.clearInterval(this._timerId),this._timerId=a.setInterval(b,c))},c.clearInterval=function(){this._timer!==null?(this._timer.postMessage(0),this._ugly_patch&&(a.clearInterval(this._ugly_patch),this._ugly_patch=0)):this._timerId!==0&&(a.clearInterval(this._timerId),this._timerId=0)};return b}(),d=function(a){var c,d;c=new webkitAudioContext,b.samplerate=c.sampleRate,d=c.createJavaScriptNode(a.streamsize,0,a.channels),d.onaudioprocess=function(b){var c,d,e,f,g;a.process(),c=a.L,d=a.R,e=b.outputBuffer.getChannelData(0),f=b.outputBuffer.getChannelData(1);for(g=e.length;g--;)e[g]=c[g],f[g]=d[g]};return{on:function(){d.connect(c.destination)},off:function(){d.disconnect()}}},e=function(a){var d,e,f,g,h;d=new Audio,d.mozSetup(a.channels,b.samplerate),b.samplerate=d.mozSampleRate,b.channels=d.mozChannels,e=new c,f=a.streamsize/b.samplerate*1e3,g=new Float32Array(a.streamsize*a.channels),h=function(){var b,c,e,f;d.mozWriteAudio(g),a.process(),b=a.L,c=a.R,e=g.length,f=b.length;while(f--)g[--e]=c[f],g[--e]=b[f]};return{on:function(){e.setInterval(h,f)},off:function(){e.clearInterval()}}};typeof webkitAudioContext=="function"?(b.env="webkit",b._sys.bind(d)):typeof Audio=="function"&&typeof (new Audio).mozSetup=="function"&&(b.env="moz",b._sys.bind(e)),b.platform="web",b._global=a,a.T=b}(a,b),typeof importScripts=="function"&&function(a,b){b.platform="web",b._global=a}(a,b),typeof process=="object"&&process.title==="node"&&function(a,b){b.platform="node",b._global=global,module.exports=b}(a,b);return b}(this)